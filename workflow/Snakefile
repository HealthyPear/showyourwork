import snakemake
from pathlib import Path
import sys


# Require Snakemake >= this version
snakemake.utils.min_version("6.7.0")


# Add our utils module to the path
HERE = Path(snakemake.workflow.workflow.current_basedir).absolute()
sys.path.insert(1, str(HERE.parents[0]))
from utils import paths


# Working directory is the top level of the user repo
workdir: paths.user.as_posix()


# This is the config file generated by the `preprocess` workflow
configfile: (paths.temp / "config.json").as_posix()


# Workflow report template
report: "report/workflow.rst"


# Hack to make the pdf generation the default rule
rule main:
    input:
        config["ms_pdf"]


# Include all other rules
include: "rules/pdf.smk"
include: "rules/figure.smk"